# Plano de Teste para Model (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Cadastro de categoria           | Uma categoria só pode ser cadastrada se possuir nome único e obrigatório              | Tentar salvar categoria sem `nome` ou com nome já existente         | A operação deve falhar com erro de validação (`required`) ou de unicidade (`unique`)                |
| Cadastro válido                 | Uma categoria com nome único e válido deve ser salva com sucesso                      | Inserir uma categoria com nome válido                               | A categoria é salva e retornada com `_id`                                                           |
| Leitura de categorias           | O sistema deve retornar todas as categorias cadastradas                               | Fazer find() e verificar leitura dos dados inseridos                | A resposta contém um array com as categorias cadastradas                                            |
| Busca por id                    | Deve retornar a categoria correta ao buscar por id                                    | Buscar categoria pelo campo `_id`                                  | Retorna a categoria correta                                                                         |
| Atualização de categoria        | Deve ser possível atualizar o nome de uma categoria válida                            | Atualizar categoria existente com novo nome                         | O nome da categoria é alterado corretamente                                                         |
| Proibição de nome duplicado     | Não deve ser possível atualizar ou cadastrar categoria com nome já existente           | Tentar cadastrar/atualizar categoria com nome já existente          | A operação deve falhar com erro de unicidade                                                        |
| Filtros de busca                | Deve aplicar filtros de busca por nome                                                | Buscar categorias com filtro de nome                               | Retorna apenas as categorias que atendem ao filtro                                                  |
| Remoção de categoria            | Uma categoria existente pode ser removida do sistema, exceto se vinculada a componentes| Fazer deleteOne() / findByIdAndDelete()                            | A categoria é removida e não aparece mais na listagem, exceto se houver vínculo com componentes     |
| Proibição de remoção com vínculo| Não deve ser possível remover categoria vinculada a componentes                       | Tentar remover categoria vinculada a componentes                    | A operação deve falhar com erro de recurso em uso                                                   |
| Categoria inexistente           | Deve retornar erro ao buscar, atualizar ou deletar categoria inexistente              | Buscar, atualizar ou deletar categoria com id inexistente           | Deve retornar erro 404 para categoria não encontrada                                                |
| Falha inesperada                | Deve retornar erro 500 para falhas inesperadas                                        | Simular erro inesperado em qualquer operação                       | Deve retornar erro 500 e mensagem padronizada                                                       |

# Plano de Teste Controller (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Validação de schema             | Deve validar o schema de entrada (nome obrigatório)                                   | Enviar requisição com dados inválidos                               | Deve retornar erro 400 para dados inválidos                                                         |
| Nome já cadastrado              | Não deve permitir cadastro com nome já existente                                      | Enviar requisição com nome já cadastrado                            | Deve retornar erro 409 para nome já cadastrado                                                      |
| Categoria não encontrada        | Deve retornar erro ao buscar, atualizar ou deletar categoria inexistente              | Buscar, atualizar ou deletar categoria inexistente                  | Deve retornar erro 404 para categoria não encontrada                                                |
| Resposta limpa                  | Não deve retornar campos desnecessários nas respostas                                 | Cadastrar, listar, atualizar categoria                             | A resposta não contém campos sensíveis ou desnecessários                                            |
| Mensagens padronizadas          | Mensagens de sucesso e erro devem ser claras e padronizadas                           | Realizar operações de sucesso e erro                                | Mensagens seguem o padrão definido                                                                  |
| Dados inválidos no cadastro     | Deve retornar erro 400 ao tentar cadastrar categoria com dados ausentes ou inválidos   | Enviar requisição sem nome                                          | Deve retornar erro 400 para dados inválidos                                                         |
| Atualização proibida            | Deve retornar erro ao tentar atualizar nome para um já existente                      | Tentar atualizar nome para um já existente                          | Deve retornar erro ou ignorar alteração, mantendo valores originais                                 |
| Falha inesperada                | Deve retornar erro 500 para falhas inesperadas no controller                          | Simular erro inesperado em qualquer operação                        | Deve retornar erro 500 e mensagem padronizada                                                       |
| Busca com filtro inválido       | Deve retornar erro 400 ao buscar categorias com filtros inválidos                     | Buscar categorias com query inválida                                | Deve retornar erro 400 para filtros inválidos                                                       |
| Remoção de categoria inexistente| Deve retornar erro 404 ao tentar remover categoria inexistente                        | Tentar deletar categoria com id inexistente                         | Deve retornar erro 404 para categoria não encontrada                                                |

# Plano de Teste Service (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Cadastro de categoria           | Deve cadastrar categoria com nome único e obrigatório                                 | Cadastrar categoria com nome válido                                 | Categoria salva e retornada com `_id`                                                               |
| Proibição de nome duplicado     | Deve lançar erro ao tentar cadastrar/atualizar categoria com nome já existente        | Cadastrar/atualizar categoria com nome já existente                 | Deve lançar erro de unicidade                                                                        |
| Categoria inexistente           | Deve lançar erro ao tentar atualizar ou deletar categoria inexistente                 | Atualizar ou deletar categoria inexistente                          | Deve lançar erro 404                                                                                |
| Remoção com vínculo             | Deve lançar erro ao tentar remover categoria vinculada a componentes                  | Tentar remover categoria vinculada a componentes                    | Deve lançar erro de recurso em uso                                                                   |
| Falha inesperada do repository  | Deve lançar erro se o repository lançar exceção em qualquer operação                  | Simular erro lançado pelo repository                               | Deve lançar erro e não comprometer a integridade dos dados                                          |
| Update com nome proibido        | Deve ignorar alterações para nome já existente                                        | Tentar atualizar nome para um já existente                          | Nome permanece inalterado após a operação                                                           |

# Plano de Teste Repository (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Buscar por nome                 | Deve buscar categoria por nome corretamente                                           | Buscar categoria pelo campo `nome`                                 | Retorna a categoria correta                                                                         |
| Buscar por id                   | Deve buscar categoria por id corretamente                                             | Buscar categoria pelo campo `_id`                                  | Retorna a categoria correta                                                                         |
| Aplicar filtros de busca        | Deve aplicar filtros de busca (nome)                                                  | Buscar categorias com diferentes filtros                            | Retorna apenas as categorias que atendem aos filtros                                                |
| Impedir remoção com vínculo     | Deve impedir remoção de categoria vinculada a componentes                             | Tentar remover categoria vinculada a componentes                    | A operação deve falhar com erro de recurso em uso                                                   |
| Erro para operações inválidas   | Deve retornar erro apropriado para operações inválidas                                | Buscar, atualizar ou deletar categoria inexistente                  | Deve retornar erro 404 para categoria não encontrada                                                |
| Buscar por nome inexistente     | Deve retornar null ou erro ao buscar categoria por nome inexistente                   | Buscar categoria com nome não cadastrado                            | Retorna null ou erro apropriado                                                                     |
| Buscar por id inexistente       | Deve retornar null ou erro ao buscar categoria por id inexistente                     | Buscar categoria com id não cadastrado                              | Retorna null ou erro apropriado                                                                     |
| Remoção de categoria inexistente| Deve lançar erro ao tentar remover categoria inexistente                              | Tentar deletar categoria com id inexistente                         | Deve lançar erro 404                                                                                |
| Erro inesperado do banco        | Deve lançar erro se o banco lançar exceção em qualquer operação                       | Simular falha do banco de dados                                    | Deve lançar erro e não comprometer a integridade dos dados                                          |

# Plano de Teste Endpoints (Sprint 6)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Listar categorias               | Deve retornar todas as categorias cadastradas via endpoint GET /categorias                | Fazer requisição GET /categorias                                    | Resposta contém array com as categorias cadastradas                                                |
| Buscar categoria por id         | Deve retornar a categoria correta via endpoint GET /categorias/:id                        | Fazer requisição GET /categorias/:id                                | Retorna a categoria correta ou erro 404 se não encontrada                                          |
| Cadastrar categoria             | Deve cadastrar categoria via endpoint POST /categorias                                    | Fazer requisição POST /categorias com dados válidos                 | Categoria cadastrada e retornada com _id                                                           |
| Cadastro inválido               | Não deve cadastrar categoria com dados inválidos via POST /categorias                 | Fazer POST /categorias sem nome ou com nome duplicado                | Retorna erro 400 ou 409 conforme o caso                                                            |
| Atualizar categoria             | Deve atualizar categoria via endpoint PUT /categorias/:id                                 | Fazer PUT /categorias/:id com novo nome                             | Nome da categoria alterado corretamente                                                            |
| Atualização inválida            | Não deve atualizar categoria com nome duplicado ou inexistente via PUT /categorias/:id | Fazer PUT /categorias/:id com nome duplicado ou id inexistente      | Retorna erro 404 ou 409 conforme o caso                                                            |
| Remover categoria               | Deve remover categoria via rota DELETE /categorias/:id                                | Fazer DELETE /categorias/:id                                        | Categoria removida, exceto se vinculada a componentes                                              |
| Remoção proibida                | Não deve remover categoria vinculada a componentes via DELETE /categorias/:id         | Fazer DELETE /categorias/:id vinculada a componentes                | Retorna erro de recurso em uso                                                                      |
| Filtros de busca                | Deve aplicar filtros via query params em GET /categorias                              | Fazer GET /categorias?nome=...                                      | Retorna apenas categorias que atendem ao filtro                                                    |
| Erro inesperado                 | Deve retornar erro 500 para falhas inesperadas nas rotas                              | Simular erro inesperado em qualquer rota                            | Retorna erro 500 e mensagem padronizada                                                            |