# Plano de Teste para Model (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Cadastro de movimentação        | Uma movimentação só pode ser cadastrada se possuir componente, tipo, quantidade e data válidos | Tentar salvar movimentação sem campos obrigatórios ou com dados inválidos | A operação deve falhar com erro de validação (`required`)                                           |
| Cadastro válido                 | Uma movimentação com todos os campos obrigatórios e válidos deve ser salva com sucesso | Inserir uma movimentação com todos os campos preenchidos corretamente | A movimentação é salva e retornada com `_id`                                                        |
| Fornecedor obrigatório em entrada| Em movimentação de entrada, o fornecedor é obrigatório e deve ser válido/existente    | Tentar cadastrar movimentação de entrada sem fornecedor ou com fornecedor inexistente | Deve falhar com erro de validação ou recurso não encontrado                                        |
| Fornecedor não exigido em saída | Em movimentação de saída, o fornecedor não é exigido                                 | Tentar cadastrar movimentação de saída sem fornecedor               | Movimentação é salva com sucesso, campo fornecedor pode ser nulo ou ausente                         |
| Leitura de movimentações        | O sistema deve retornar todas as movimentações cadastradas                            | Fazer find() e verificar leitura dos dados inseridos                | A resposta contém um array com as movimentações cadastradas                                         |
| Atualização de movimentação     | Deve ser possível atualizar informações permitidas de uma movimentação válida          | Atualizar movimentação existente com novos dados permitidos         | A movimentação deve refletir os dados alterados                                                     |
| Proibição de update de campos restritos | Não deve ser possível alterar campos como componente ou tipo após cadastro         | Tentar atualizar campo `componente` ou `tipo`                      | Os campos permanecem inalterados após a operação                                                    |
| Remoção de movimentação         | Uma movimentação existente pode ser removida do sistema                               | Fazer deleteOne() / findByIdAndDelete()                            | A movimentação é removida e não aparece mais na listagem                                            |
| Movimentação inexistente        | Deve retornar erro ao buscar, atualizar ou deletar movimentação inexistente           | Buscar, atualizar ou deletar movimentação com id inexistente        | Deve retornar erro 404 para movimentação não encontrada                                             |
| Falha inesperada                | Deve retornar erro 500 para falhas inesperadas                                        | Simular erro inesperado em qualquer operação                       | Deve retornar erro 500 e mensagem padronizada                                                      |

# Plano de Teste Controller (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Validação de schema             | Deve validar o schema de entrada (campos obrigatórios e tipos)                        | Enviar requisição com dados inválidos                               | Deve retornar erro 400 para dados inválidos                                                         |
| Cadastro duplicado ou inválido  | Não deve permitir cadastro com dados inválidos ou duplicados                          | Enviar requisição com dados inválidos ou duplicados                 | Deve retornar erro 400 ou 409 conforme o caso                                                      |
| Movimentação não encontrada     | Deve retornar erro ao buscar, atualizar ou deletar movimentação inexistente           | Buscar, atualizar ou deletar movimentação inexistente               | Deve retornar erro 404 para movimentação não encontrada                                             |
| Resposta limpa                  | Não deve retornar campos desnecessários nas respostas                                 | Cadastrar, listar, atualizar movimentação                          | A resposta não contém campos sensíveis ou desnecessários                                            |
| Mensagens padronizadas          | Mensagens de sucesso e erro devem ser claras e padronizadas                           | Realizar operações de sucesso e erro                                | Mensagens seguem o padrão definido                                                                  |
| Dados inválidos no cadastro     | Deve retornar erro 400 ao tentar cadastrar movimentação com dados ausentes ou inválidos| Enviar requisição sem campos obrigatórios                           | Deve retornar erro 400 para dados inválidos                                                         |
| Atualização proibida            | Deve retornar erro ao tentar atualizar campos restritos (componente/tipo)             | Tentar atualizar campo restrito                                    | Deve retornar erro ou ignorar alteração, mantendo valores originais                                 |
| Falha inesperada                | Deve retornar erro 500 para falhas inesperadas no controller                          | Simular erro inesperado em qualquer operação                        | Deve retornar erro 500 e mensagem padronizada                                                       |
| Busca com filtro inválido       | Deve retornar erro 400 ao buscar movimentações com filtros inválidos                  | Buscar movimentações com query inválida                             | Deve retornar erro 400 para filtros inválidos                                                       |
| Remoção de movimentação inexistente| Deve retornar erro 404 ao tentar remover movimentação inexistente                    | Tentar deletar movimentação com id inexistente                      | Deve retornar erro 404 para movimentação não encontrada                                             |

# Plano de Teste Service (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Cadastro de movimentação        | Deve cadastrar movimentação com todos os campos obrigatórios e válidos                | Cadastrar movimentação com dados válidos                            | Movimentação salva e retornada com `_id`                                                            |
| Proibição de update de campos restritos | Deve lançar erro ao tentar atualizar campos restritos (componente/tipo)           | Atualizar movimentação alterando campo restrito                     | Deve lançar erro ou ignorar alteração                                                               |
| Movimentação inexistente        | Deve lançar erro ao tentar atualizar ou deletar movimentação inexistente              | Atualizar ou deletar movimentação inexistente                       | Deve lançar erro 404                                                                                |
| Falha inesperada do repository  | Deve lançar erro se o repository lançar exceção em qualquer operação                  | Simular erro lançado pelo repository                               | Deve lançar erro e não comprometer a integridade dos dados                                          |
| Update com dados inválidos      | Deve lançar erro ao tentar atualizar movimentação com dados inválidos                  | Atualizar movimentação com dados inválidos                          | Deve lançar erro de validação                                                                       |

# Plano de Teste Repository (Sprint 4)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Buscar por componente           | Deve buscar movimentação por componente corretamente                                  | Buscar movimentação pelo campo `componente`                         | Retorna as movimentações corretas                                                                    |
| Buscar por id                   | Deve buscar movimentação por id corretamente                                          | Buscar movimentação pelo campo `_id`                                | Retorna a movimentação correta                                                                       |
| Aplicar filtros de busca        | Deve aplicar filtros de busca (tipo, data, componente)                                | Buscar movimentações com diferentes filtros                         | Retorna apenas as movimentações que atendem aos filtros                                             |
| Erro para operações inválidas   | Deve retornar erro apropriado para operações inválidas                                | Buscar, atualizar ou deletar movimentação inexistente               | Deve retornar erro 404 para movimentação não encontrada                                             |
| Buscar por id inexistente       | Deve retornar null ou erro ao buscar movimentação por id inexistente                  | Buscar movimentação com id não cadastrado                           | Retorna null ou erro apropriado                                                                     |
| Remoção de movimentação inexistente| Deve lançar erro ao tentar remover movimentação inexistente                          | Tentar deletar movimentação com id inexistente                      | Deve lançar erro 404                                                                                |
| Erro inesperado do banco        | Deve lançar erro se o banco lançar exceção em qualquer operação                       | Simular falha do banco de dados                                    | Deve lançar erro e não comprometer a integridade dos dados                                          |

# Plano de Teste Endpoints (Sprint 6)

| Funcionalidade                  | Comportamento Esperado                                                                 | Verificações                                                        | Critérios de Aceite                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| Listar movimentações            | Deve retornar todas as movimentações via GET /movimentacoes                           | Fazer requisição GET /movimentacoes                                 | Resposta contém array com as movimentações cadastradas                                             |
| Buscar movimentação por id      | Deve retornar a movimentação correta via GET /movimentacoes/:id                       | Fazer requisição GET /movimentacoes/:id                             | Retorna a movimentação correta ou erro 404 se não encontrada                                      |
| Cadastrar movimentação          | Deve cadastrar movimentação via POST /movimentacoes                                   | Fazer POST /movimentacoes com dados válidos                         | Movimentação cadastrada e retornada com _id                                                        |
| Cadastro inválido               | Não deve cadastrar movimentação com dados inválidos via POST /movimentacoes           | Fazer POST /movimentacoes sem campos obrigatórios ou inválidos       | Retorna erro 400 ou 409 conforme o caso                                                            |
| Atualizar movimentação          | Deve atualizar movimentação via PUT /movimentacoes/:id                                | Fazer PUT /movimentacoes/:id com dados válidos                      | Dados da movimentação alterados corretamente                                                       |
| Atualização proibida            | Não deve atualizar campos restritos via PUT /movimentacoes/:id                        | Fazer PUT /movimentacoes/:id tentando alterar campos restritos       | Campos restritos permanecem inalterados                                                            |
| Remover movimentação            | Deve remover movimentação via DELETE /movimentacoes/:id                               | Fazer DELETE /movimentacoes/:id                                     | Movimentação removida                                                                              |
| Movimentação inexistente        | Deve retornar erro ao buscar, atualizar ou deletar movimentação inexistente           | Fazer GET/PUT/DELETE /movimentacoes/:id com id inexistente          | Retorna erro 404 para movimentação não encontrada                                                  |
| Filtros de busca                | Deve aplicar filtros via query params em GET /movimentacoes                           | Fazer GET /movimentacoes?tipo=...                                   | Retorna apenas movimentações que atendem ao filtro                                                 |
| Erro inesperado                 | Deve retornar erro 500 para falhas inesperadas nas rotas                              | Simular erro inesperado em qualquer rota                            | Retorna erro 500 e mensagem padronizada                                                            |